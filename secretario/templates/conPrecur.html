{% extends "layout.html" %}

{% block contenido %}

	<div class="col-lg-12">
		<div class="form-panel row">
		    <div class="visible-md visible-lg">
				<h1 class="text-center titlecolor"><i class="fa fa-angle-right"></i>Consulta de Precursores</h1>
			</div>
			<div class="visible-xs visible-sm">
				<h3 class="text-center"><i class="fa fa-angle-right"></i>Consulta de Precursores</h3>
			</div>

	<div class="style-form">
		{% csrf_token %}
		<div class="form-group">


            <div class="col-lg-3" style="margin-top: 28px">
                {{ precur.precur }}
            </div>
            
            <div class="col-lg-3" style="margin-top: 28px">
                <input type="checkbox" id="status" checked>
            </div>

            <div class="col-lg-3" style="margin-top: 28px">
                <select id="precur" class="form-control">
                    <option value="">Seleccione El Precursor</option>
                </select>
            </div>
            
            <div class="col-lg-3" style="margin-top: 28px">
                <select id="periodo" class="form-control">
                    <option value="">seleccione</option>
                    <option value=1>Activo</option>
                    <option value=2>Desactivo</option>
                    <option value=3>Todos</option>
                </select>
            </div>


            <div class="col-lg-8 col-md-offset-2 tabla-top">
                <div class="content-panel">

                    <h3 class="text-center titlecolor" style="margin:0px;padding: 0px;">Datos del Precursor Auxiliar</h3>
                    <fieldset class="form-inline">
                        <legend>Precursorado Activo</legend>
                            <label for="" class="col-md-2">Fecha de Inicio:</label>
                            <div class="col-md-2">
                                <span id="fechaI" class="preAux">2016-04</span>
                            </div>

                            <label for="" class="col-md-2">Fecha de Fin:</label>
                            <div class="col-md-2">
                                <span id="fechaC" class="preAux">2016-06</span>
                            </div>

                            <label for="" class="col-md-2">Duración:</label>
                            <div class="col-md-2">
                                <span id="duracion" class="preAux">2 meses</span>
                            </div>
                    </fieldset>

                    <section id="no-more-tables" style="margin-top: 20px;">

                        <table id="public" class="table table-bordered table-striped table-condensed cf" style="font-size:14px;">
                            <thead class="cf">
                                <tr>
                                    <th class="numeric text-center">Fecha</th>
                                    <th class="numeric text-center">Horas Requeridas</th>
                                    <th class="numeric text-center">Horas Informadas</th>
                                    <th class="numeric text-center" style="width:8%;">Objetivo</th>
                                </tr>
                            </thead>
                            <tbody>
                                <tr>
                                    <td class="numeric text-center" data-title="Edad">
                                    </td>
                                    <td class="numeric text-center bau" data-title="Fecha de Bautismo">
                                    </td>
                                    <td class="numeric" data-title="Grupo Asignado" >
                                    </td>
                                    <td class="numeric estado"  data-title="Estado" style="width:8%; background-color:#09B20F">
                                    </td>
                                </tr>
                            </tbody>
                        </table>
                    </section>
                </div>
			</div>

            <div class="col-lg-8 col-md-offset-2 tabla-top">
                <div class="content-panel">

                    <h3 class="text-center titlecolor" style="margin-bottom:10px;">
                       Precursor(a): <span style="color: darkcyan;">Dorca de Acevedo</span>
                    </h3>
                    <h3 class="text-center titlecolor" style="margin:0px;padding: 0px;">
                        Año de servicio: <span style="color: darkcyan;">2015-2016</span>
                    </h3>

                    <section id="no-more-tables" style="margin-top: 20px;">

                        <table id="public" class="table table-bordered table-striped table-condensed cf" style="font-size:14px;">
                            <thead class="cf">
                                <tr>
                                    <th class="numeric text-center">Fecha</th>
                                    <th class="numeric text-center">Horas Realizadas</th>
                                    <th class="numeric text-center">Horas Acumuladas</th>
                                    <th class="numeric text-center">Total de Horas</th>
                                    <th class="numeric text-center">Total Restante</th>
                                    <th class="numeric text-center" style="width:8%;">Objetivo</th>
                                </tr>
                            </thead>
                            <tbody>
                                <tr>
                                    <td class="numeric nombre" data-title="Nombre y Apellido">

                                    </td>
                                    <td class="numeric text-center" data-title="Edad">

                                    </td>
                                    <td class="numeric text-center bau" data-title="Fecha de Bautismo">

                                    </td>
                                    <td class="numeric" data-title="Grupo Asignado" >

                                    </td>

                                    <td class="numeric estado"  data-title="Estado">
                                    </td>

                                    <td class="numeric estado"  data-title="Estado">
                                    </td>
                                </tr>
                            </tbody>
                        </table>
                    </section>
                </div>
			</div>
		</div>

    </div>
       
        </div>
</div>

{% endblock %}

{% block scripts %}

    <script>

        function getPrecur(status){
            $.post("{% url 'secretario:conPrecs' %}",{
                'precur': $("#id_precur").val(),
                'status': status,
                csrfmiddlewaretoken:'{{ csrf_token }}'
            })
            .success(function(res){
                res=JSON.parse(res)
                console.log(res)

                $('#precur option:first').siblings().detach()

                $.each(res.p, function(key, value){
                    $('#precur').append(new Option(""+value.nombre, ""+value.pk))
                })
            })
        }

        $("#status").bootstrapSwitch({
            disabled: true,
            onText: 'Activo',
            offText: 'Inactivo',
            offColor: 'danger',
            indeterminate: true
        });

        $("#id_precur").change(function(){
            if (this.value != ""){
                $("#status").bootstrapSwitch('disabled', false)

                if( !$("#status").bootstrapSwitch('indeterminate') ){
                    x = $("#status").bootstrapSwitch('state')
                    status = x == false ? 0 : 1
                    getPrecur(status)
                }
            } else{
                $("#status").bootstrapSwitch('toggleIndeterminate')
                $("#status").bootstrapSwitch('toggleDisabled')
            }
        })

        $("div.bootstrap-switch-container > span").click(function(){
            if( !$("#status").bootstrapSwitch('disabled') ){
                x = $("#status").bootstrapSwitch('state')
                status = x == false ? 0 : 1
                getPrecur(status)
            }
        })
    </script>

{% endblock %}
